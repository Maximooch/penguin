/* ===============================================
   Penguin TUI Theme & Layout System
   Default Theme: Ocean; Layout: Flat
   =============================================== */

Screen {
    layout: vertical;
    background: #0c141f;
    color: #dadada;
}

/* ===============================================
   Core Layout Components
   =============================================== */

Header {
    dock: top;
    height: 1;
    background: #1a2a3f;
    color: #89cff0;
    text-align: center;
}

Footer {
    dock: bottom;
    height: 1;
    background: #1a2a3f;
}

Footer .footer--key { background: #334e68; color: #89cff0; }

Footer .footer--highlight-key { background: #89cff0; color: #0c141f; }

#main-container { layout: horizontal; padding: 0 1; height: 1fr; }
#center-pane { layout: vertical; height: 1fr; width: 1fr; }
#status-sidebar { width: 36; dock: right; background: #0f1826; color: #89cff0; padding: 0 1; border: round #334e68; }

#message-area {
    height: 1fr;
    width: 100%;
    scrollbar-gutter: stable;
    min-height: 0; /* ensure scroll container shrinks to content */
}

#input-box { border: round #89cff0; height: 3; background: #1a2a3f; color: #dadada; margin: 1 0 0 0; }

#input-box:focus {
    border: round #b3e5fc;
}

#status-bar { dock: bottom; height: 1; background: #1a2a3f; color: #a0a0a0; padding: 0 1; text-align: left; }

/* Micro status row (detailed view only; hidden in compact by default) */
#micro-status {
    dock: bottom;
    height: 1;
    background: #0f1826;
    color: #89cff0;
    padding: 0 1;
}

/* Breadcrumb/status bar (Claude-like). Hidden unless enabled by app. */
#crumb-bar {
    height: 1;
    background: #0f1826;
    color: #89cff0;
    padding: 0 1;
    display: none;
    layer: above;  /* keep above message area but below header */
}

/* ===============================================
   Chat Message Styling
   =============================================== */

/* Boxed layout - tighter spacing */
.layout-boxed ChatMessage { padding: 0 1; margin: 1 0; background: #101c2c; border: round #334e68; width: 100%; height: auto; layout: vertical; }
/* Flat layout - minimal spacing */
.layout-flat ChatMessage { padding: 0 1; margin: 0 0 1 0; background: transparent; border: none; width: 100%; height: auto; layout: vertical; }

.message-label { display: none; height: 0; margin: 0; padding: 0; }

.message-content {
    height: auto;
    margin: 0;           /* remove default block margins */
    min-height: 0;       /* prevent reserved vertical space */
}

/* Role label colors removed to reduce noise (inherit screen color by default). */

/* Role ribbons in flat layout - more subtle */
.layout-flat .message-content.assistant { border-left: solid #7dd3fc; }
.layout-flat .message-content.user { border-left: solid #86efac; }
.layout-flat .message-content.system { border-left: solid #fcd34d; }
.layout-flat .message-content.error { border-left: solid #fca5a5; background: rgba(239,83,80,0.08); }
.layout-flat .message-content { padding-left: 1; margin-top: 0; }

/* Tool chain gutter connector (compact) */
/* Both call and result share the same left border to visually connect */
ChatMessage.tool-call .message-content { border-left: solid #57c7ff; }
ChatMessage.tool-result .message-content { border-left: solid #57c7ff; }
ChatMessage.tool-call .message-content,
ChatMessage.tool-result .message-content { padding-left: 1; }

/* Assistant headline (compact) - more subtle */
.msg-head { color: #93c5fd; text-style: bold; padding: 0 1 0 1; margin: 0; }

/* Streaming highlight */
.layout-boxed ChatMessage.streaming { border: round #89cff0; background: #1a2a3f; }

/* Focus outline for keyboard navigation */
.layout-boxed ChatMessage:focus { border: round #89cff0; background: #162436; }
.layout-flat ChatMessage:focus .message-content { background: #162436; }

/* Code block inside messages - tighter, subtler */
.code-block { padding: 0 1; margin-top: 0; margin-bottom: 0; background: #0d1520; border: round #2a3f54; }

/* ===============================================
   Tool Execution Widget Styles
   =============================================== */

.tool-execution { margin: 1 0 0 0; padding: 0 1; background: #0d1520; border: round #2a3f54; }

.tool-execution:focus { border: round #89cff0; background: #162436; }

.tool-container {
    layout: vertical;
    width: 100%;
}

.tool-header { padding: 0; background: transparent; border: none; text-style: none; }

.tool-params-section { margin: 1 0 0 0; background: #0d1520; border: round #2a3f54; padding: 0; }

.tool-params-content { padding: 0 1; color: #9ca3af; min-height: 0; margin: 0; }

.tool-result-section { margin: 1 0 0 0; background: #0d1520; border: round #2a3f54; padding: 0; min-height: 0; }

.tool-result-content { padding: 0 1; min-height: 0; margin: 0; }

/* Tool status colors */
.tool-status-pending {
    color: #ffd54f;
}

.tool-status-running {
    color: #ffeb3b;
    text-style: bold;
}

.tool-status-success { color: #66bb6a; }

.tool-status-failed {
    color: #ef5350;
}

.tool-status-cancelled {
    color: #757575;
}

/* ===============================================
   Collapsible Sections
   =============================================== */

Collapsible { background: #0d1520; border: round #2a3f54; margin: 0; min-height: 0; }

/* Inside tool cards and messages, no extra margin */
.tool-execution Collapsible,
ChatMessage Collapsible {
    margin: 0;
    min-height: 0;
}

Collapsible > .label { padding: 0 1; background: #0d1520; color: #7dd3fc; }

Collapsible:focus > .label {
    background: #162436;
    color: #b3e5fc;
}

/* ===============================================
   Utility Classes
   =============================================== */

.hidden {
    display: none;
}

.dim {
    opacity: 0.7;
}

.error-text {
    color: #ffcdd2;
}

.success-text {
    color: #66bb6a;
}

.warning-text {
    color: #ffd54f;
}

/* Reasoning / blockquote styling - more muted */
Markdown BlockQuote { color: #9ca3af; text-style: italic; border-left: thick #2a3f54; padding-left: 1; }

/* ===============================================
   RunMode Output Styling
   =============================================== */

.runmode-output { background: #162436; border: round #89cff0; padding: 1; margin: 1 0; }

/* Theme variants (class added to App). These override key colors. */
.theme-ocean { background:#0c141f; color:#dadada; }
.theme-ocean Header, .theme-ocean Footer { background:#1a2a3f; }
.theme-ocean #status-bar { background:#1a2a3f; }

.theme-nord { background:#2e3440; color:#eceff4; }
.theme-nord Header, .theme-nord Footer { background:#3b4252; }
.theme-nord #status-bar { background:#3b4252; }
.theme-nord #input-box { border: round #88c0d0; background:#3b4252; color:#eceff4; }
.theme-nord Footer .footer--key { background:#4c566a; color:#88c0d0; }
.theme-nord Footer .footer--highlight-key { background:#88c0d0; color:#2e3440; }
.theme-nord .layout-boxed ChatMessage { background:#2b3240; border: round #4c566a; }
.theme-nord .tool-execution { background:#2b3240; border: round #4c566a; }
.theme-nord .tool-header { background:#3b4252; border-bottom: solid #4c566a; }
.theme-nord Collapsible { background:#2b3240; border: round #4c566a; }
.theme-nord Collapsible > .label { background:#3b4252; color:#88c0d0; }
.theme-nord Markdown BlockQuote { border-left: thick #4c566a; }
.theme-nord .runmode-output { border: round #88c0d0; }
.theme-nord .layout-flat .message-content.assistant { border-left: solid #88c0d0; }
.theme-nord .layout-flat .message-content.user { border-left: solid #a3be8c; }
.theme-nord .layout-flat .message-content.system { border-left: solid #ebcb8b; }
.theme-nord .layout-flat .message-content.error { border-left: solid #bf616a; background: rgba(191,97,106,0.12); }

.theme-dracula { background:#282a36; color:#f8f8f2; }
.theme-dracula Header, .theme-dracula Footer { background:#44475a; }
.theme-dracula #status-bar { background:#44475a; }
.theme-dracula #input-box { border: round #8be9fd; background:#44475a; color:#f8f8f2; }
.theme-dracula Footer .footer--key { background:#6272a4; color:#8be9fd; }
.theme-dracula Footer .footer--highlight-key { background:#8be9fd; color:#282a36; }
.theme-dracula .layout-boxed ChatMessage { background:#232531; border: round #6272a4; }
.theme-dracula .tool-execution { background:#232531; border: round #6272a4; }
.theme-dracula .tool-header { background:#44475a; border-bottom: solid #6272a4; }
.theme-dracula Collapsible { background:#232531; border: round #6272a4; }
.theme-dracula Collapsible > .label { background:#44475a; color:#8be9fd; }
.theme-dracula Markdown BlockQuote { border-left: thick #6272a4; }
.theme-dracula .runmode-output { border: round #8be9fd; }
.theme-dracula .layout-flat .message-content.assistant { border-left: solid #8be9fd; }
.theme-dracula .layout-flat .message-content.user { border-left: solid #50fa7b; }
.theme-dracula .layout-flat .message-content.system { border-left: solid #f1fa8c; }
.theme-dracula .layout-flat .message-content.error { border-left: solid #ff5555; background: rgba(255,85,85,0.12); }

/* ===============================================
   Minimal Mode (Claude Codeâ€“like, messages only)
   Applies when root has class .mode-minimal
   Does NOT alter input bar or sidebar
   =============================================== */
.mode-minimal .layout-flat ChatMessage { padding: 0 1; margin: 0 0 1 0; background: transparent; border: none; }
.mode-minimal .layout-flat .message-content { border-left: none; }
.mode-minimal .msg-head { color: #b3e5fc; }
.mode-minimal .code-block { background: #0f1826; border: none; }

/* Collapsed older messages: hide narrative, keep headline */
ChatMessage.collapsed .message-content { display: none; }
ChatMessage.collapsed .msg-head { display: block; }

/* Whole-message collapsing: show only a compact summary line */
ChatMessage.collapsed {
    height: auto;
    min-height: 1;
    margin: 0 0 0 0;
    padding: 0 1;
    background: rgba(125, 211, 252, 0.03);
    border-left: solid #7dd3fc;
}

/* Make collapsed messages clickable to expand */
ChatMessage.collapsed:hover {
    background: rgba(125, 211, 252, 0.08);
}

ChatMessage.collapsed:focus {
    background: rgba(125, 211, 252, 0.10);
    border-left: solid #bae6fd;
}

/* Style for collapse summary text - compact */
.collapse-summary {
    color: #93c5fd;
    padding: 0;
    margin: 0;
    height: 1;
}

/* ===============================================
   Message Style Variants (root classes):
   .style-soft (default), .style-boxed, .style-line
   =============================================== */
.style-soft .layout-flat .message-content.assistant { border-left: solid #7dd3fc; }
.style-soft .layout-flat .message-content.user { border-left: solid #86efac; }
.style-soft .layout-flat .message-content.system { border-left: solid #fcd34d; }

.style-boxed ChatMessage { background: #0d1520; border: round #2a3f54; padding: 0 1; margin: 1 0; }
.style-boxed .code-block { background: #0a0f16; border: round #2a3f54; }

.style-line .layout-flat .message-content { border-left: none; padding-left: 0; }
.style-line ChatMessage { border: none; background: transparent; margin: 0; padding: 0 1; }
.style-line .code-block { background: #0a0f16; border: none; }

/* ===============================================
   Future Theme Templates
   =============================================== */

/* Nord Theme (for future implementation)
.theme-nord Screen {
    background: #2e3440;
    color: #eceff4;
}

.theme-nord Header,
.theme-nord Footer {
    background: #3b4252;
    color: #88c0d0;
}
*/

/* Dracula Theme (for future implementation)
.theme-dracula Screen {
    background: #282a36;
    color: #f8f8f2;
}

.theme-dracula Header,
.theme-dracula Footer {
    background: #44475a;
    color: #bd93f9;
}
*/

/* Tighten Markdown spacing inside tool sections to avoid large trailing gaps */
.tool-params-content Markdown,
.tool-result-content Markdown {
    margin: 0;
}

/* Keep code blocks compact inside cards */
.tool-params-content .code-block,
.tool-result-content .code-block {
    margin-top: 0;
    margin-bottom: 0;
}

/* Remove extra spacing added by Collapsible container body */
.tool-params-section > .content,
.tool-result-section > .content {
    padding: 0;
    margin: 0;
    min-height: 0;
}

/* Ensure Markdown inside collapsibles doesn't reserve space when empty */
.tool-params-content,
.tool-result-content {
    min-height: 0;
    height: auto;
}

/* Make Collapsible bodies shrink to fit content to avoid trailing whitespace */
.tool-params-section,
.tool-result-section,
.tool-execution {
    min-height: 0;
}